module.exports=[94967,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/components/mansonry.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/mansonry.jsx <module evaluation>","default");a.s(["default",0,b])},30880,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/components/mansonry.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/mansonry.jsx","default");a.s(["default",0,b])},46534,a=>{"use strict";a.i(94967);var b=a.i(30880);a.n(b)},9778,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=class extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}}},67156,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(89431)),f=d(a.r(9778));c.default=class{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:"undefined"==typeof fetch?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,b){return this.headers=Object.assign({},this.headers),this.headers[a]=b,this}then(a,b){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let c=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var b,c,d;let e=null,g=null,h=null,i=a.status,j=a.statusText;if(a.ok){if("HEAD"!==this.method){let b=await a.text();""===b||(g="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?b:JSON.parse(b))}let d=null==(b=this.headers.Prefer)?void 0:b.match(/count=(exact|planned|estimated)/),f=null==(c=a.headers.get("content-range"))?void 0:c.split("/");d&&f&&f.length>1&&(h=parseInt(f[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(g)&&(g.length>1?(e={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,h=null,i=406,j="Not Acceptable"):g=1===g.length?g[0]:null)}else{let b=await a.text();try{e=JSON.parse(b),Array.isArray(e)&&404===a.status&&(g=[],e=null,i=200,j="OK")}catch(c){404===a.status&&""===b?(i=204,j="No Content"):e={message:b}}if(e&&this.isMaybeSingle&&(null==(d=null==e?void 0:e.details)?void 0:d.includes("0 rows"))&&(e=null,i=200,j="OK"),e&&this.shouldThrowOnError)throw new f.default(e)}return{error:e,data:g,count:h,status:i,statusText:j}});return this.shouldThrowOnError||(c=c.catch(a=>{var b,c,d;return{error:{message:`${null!=(b=null==a?void 0:a.name)?b:"FetchError"}: ${null==a?void 0:a.message}`,details:`${null!=(c=null==a?void 0:a.stack)?c:""}`,hint:"",code:`${null!=(d=null==a?void 0:a.code)?d:""}`},data:null,count:null,status:0,statusText:""}})),c.then(a,b)}returns(){return this}overrideTypes(){return this}}},53185,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(67156));class f extends e.default{select(a){let b=!1,c=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!b?"":('"'===a&&(b=!b),a)).join("");return this.url.searchParams.set("select",c),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:b=!0,nullsFirst:c,foreignTable:d,referencedTable:e=d}={}){let f=e?`${e}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${b?"asc":"desc"}${void 0===c?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:b,referencedTable:c=b}={}){let d=void 0===c?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,b,{foreignTable:c,referencedTable:d=c}={}){let e=void 0===d?"offset":`${d}.offset`,f=void 0===d?"limit":`${d}.limit`;return this.url.searchParams.set(e,`${a}`),this.url.searchParams.set(f,`${b-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:b=!1,settings:c=!1,buffers:d=!1,wal:e=!1,format:f="text"}={}){var g;let h=[a?"analyze":null,b?"verbose":null,c?"settings":null,d?"buffers":null,e?"wal":null].filter(Boolean).join("|"),i=null!=(g=this.headers.Accept)?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${i}"; options=${h};`,this}rollback(){var a;return(null!=(a=this.headers.Prefer)?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}c.default=f},53613,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(53185));class f extends e.default{eq(a,b){return this.url.searchParams.append(a,`eq.${b}`),this}neq(a,b){return this.url.searchParams.append(a,`neq.${b}`),this}gt(a,b){return this.url.searchParams.append(a,`gt.${b}`),this}gte(a,b){return this.url.searchParams.append(a,`gte.${b}`),this}lt(a,b){return this.url.searchParams.append(a,`lt.${b}`),this}lte(a,b){return this.url.searchParams.append(a,`lte.${b}`),this}like(a,b){return this.url.searchParams.append(a,`like.${b}`),this}likeAllOf(a,b){return this.url.searchParams.append(a,`like(all).{${b.join(",")}}`),this}likeAnyOf(a,b){return this.url.searchParams.append(a,`like(any).{${b.join(",")}}`),this}ilike(a,b){return this.url.searchParams.append(a,`ilike.${b}`),this}ilikeAllOf(a,b){return this.url.searchParams.append(a,`ilike(all).{${b.join(",")}}`),this}ilikeAnyOf(a,b){return this.url.searchParams.append(a,`ilike(any).{${b.join(",")}}`),this}is(a,b){return this.url.searchParams.append(a,`is.${b}`),this}in(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cs.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cs.{${b.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(b)}`),this}containedBy(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cd.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cd.{${b.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(b)}`),this}rangeGt(a,b){return this.url.searchParams.append(a,`sr.${b}`),this}rangeGte(a,b){return this.url.searchParams.append(a,`nxl.${b}`),this}rangeLt(a,b){return this.url.searchParams.append(a,`sl.${b}`),this}rangeLte(a,b){return this.url.searchParams.append(a,`nxr.${b}`),this}rangeAdjacent(a,b){return this.url.searchParams.append(a,`adj.${b}`),this}overlaps(a,b){return"string"==typeof b?this.url.searchParams.append(a,`ov.${b}`):this.url.searchParams.append(a,`ov.{${b.join(",")}}`),this}textSearch(a,b,{config:c,type:d}={}){let e="";"plain"===d?e="pl":"phrase"===d?e="ph":"websearch"===d&&(e="w");let f=void 0===c?"":`(${c})`;return this.url.searchParams.append(a,`${e}fts${f}.${b}`),this}match(a){return Object.entries(a).forEach(([a,b])=>{this.url.searchParams.append(a,`eq.${b}`)}),this}not(a,b,c){return this.url.searchParams.append(a,`not.${b}.${c}`),this}or(a,{foreignTable:b,referencedTable:c=b}={}){let d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,b,c){return this.url.searchParams.append(a,`${b}.${c}`),this}}c.default=f},97680,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(53613));c.default=class{constructor(a,{headers:b={},schema:c,fetch:d}){this.url=a,this.headers=b,this.schema=c,this.fetch=d}select(a,{head:b=!1,count:c}={}){let d=!1,f=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!d?"":('"'===a&&(d=!d),a)).join("");return this.url.searchParams.set("select",f),c&&(this.headers.Prefer=`count=${c}`),new e.default({method:b?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:b,defaultToNull:c=!0}={}){let d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),b&&d.push(`count=${b}`),c||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new e.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:b,ignoreDuplicates:c=!1,count:d,defaultToNull:f=!0}={}){let g=[`resolution=${c?"ignore":"merge"}-duplicates`];if(void 0!==b&&this.url.searchParams.set("on_conflict",b),this.headers.Prefer&&g.push(this.headers.Prefer),d&&g.push(`count=${d}`),f||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new e.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:b}={}){let c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),b&&c.push(`count=${b}`),this.headers.Prefer=c.join(","),new e.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){let b=[];return a&&b.push(`count=${a}`),this.headers.Prefer&&b.unshift(this.headers.Prefer),this.headers.Prefer=b.join(","),new e.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},68021,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.version=void 0,c.version="0.0.0-automated"},3699,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_HEADERS=void 0;let d=a.r(68021);c.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${d.version}`}},27141,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0});let e=d(a.r(97680)),f=d(a.r(53613)),g=a.r(3699);class h{constructor(a,{headers:b={},schema:c,fetch:d}={}){this.url=a,this.headers=Object.assign(Object.assign({},g.DEFAULT_HEADERS),b),this.schemaName=c,this.fetch=d}from(a){let b=new URL(`${this.url}/${a}`);return new e.default(b,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new h(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,b={},{head:c=!1,get:d=!1,count:e}={}){let g,h,i=new URL(`${this.url}/rpc/${a}`);c||d?(g=c?"HEAD":"GET",Object.entries(b).filter(([a,b])=>void 0!==b).map(([a,b])=>[a,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([a,b])=>{i.searchParams.append(a,b)})):(g="POST",h=b);let j=Object.assign({},this.headers);return e&&(j.Prefer=`count=${e}`),new f.default({method:g,url:i,headers:j,schema:this.schemaName,body:h,fetch:this.fetch,allowEmpty:!1})}}c.default=h},14504,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.PostgrestError=c.PostgrestBuilder=c.PostgrestTransformBuilder=c.PostgrestFilterBuilder=c.PostgrestQueryBuilder=c.PostgrestClient=void 0;let e=d(a.r(27141));c.PostgrestClient=e.default;let f=d(a.r(97680));c.PostgrestQueryBuilder=f.default;let g=d(a.r(53613));c.PostgrestFilterBuilder=g.default;let h=d(a.r(53185));c.PostgrestTransformBuilder=h.default;let i=d(a.r(67156));c.PostgrestBuilder=i.default;let j=d(a.r(9778));c.PostgrestError=j.default,c.default={PostgrestClient:e.default,PostgrestQueryBuilder:f.default,PostgrestFilterBuilder:g.default,PostgrestTransformBuilder:h.default,PostgrestBuilder:i.default,PostgrestError:j.default}},31017,a=>{"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=a.i(7997),x=a.i(46534);class y extends Error{constructor(a,b="FunctionsError",c){super(a),this.name=b,this.context=c}}class z extends y{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class A extends y{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class B extends y{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}(b=l||(l={})).Any="any",b.ApNortheast1="ap-northeast-1",b.ApNortheast2="ap-northeast-2",b.ApSouth1="ap-south-1",b.ApSoutheast1="ap-southeast-1",b.ApSoutheast2="ap-southeast-2",b.CaCentral1="ca-central-1",b.EuCentral1="eu-central-1",b.EuWest1="eu-west-1",b.EuWest2="eu-west-2",b.EuWest3="eu-west-3",b.SaEast1="sa-east-1",b.UsEast1="us-east-1",b.UsWest1="us-west-1",b.UsWest2="us-west-2";class C{constructor(b,{headers:c={},customFetch:d,region:e=l.Any}={}){this.url=b,this.headers=c,this.region=e,this.fetch=(b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(16407).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)})(d)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a,b={}){var c,d,e,f,g;return d=this,e=void 0,f=void 0,g=function*(){try{let d,{headers:e,method:f,body:g}=b,h={},{region:i}=b;i||(i=this.region),i&&"any"!==i&&(h["x-region"]=i),g&&(e&&!Object.prototype.hasOwnProperty.call(e,"Content-Type")||!e)&&("undefined"!=typeof Blob&&g instanceof Blob||g instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",d=g):"string"==typeof g?(h["Content-Type"]="text/plain",d=g):"undefined"!=typeof FormData&&g instanceof FormData?d=g:(h["Content-Type"]="application/json",d=JSON.stringify(g)));let j=yield this.fetch(`${this.url}/${a}`,{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),e),body:d}).catch(a=>{throw new z(a)}),k=j.headers.get("x-relay-error");if(k&&"true"===k)throw new A(j);if(!j.ok)throw new B(j);let l=(null!=(c=j.headers.get("Content-Type"))?c:"text/plain").split(";")[0].trim();return{data:"application/json"===l?yield j.json():"application/octet-stream"===l?yield j.blob():"text/event-stream"===l?j:"multipart/form-data"===l?yield j.formData():yield j.text(),error:null}}catch(a){return{data:null,error:a}}},new(f||(f=Promise))(function(a,b){function c(a){try{i(g.next(a))}catch(a){b(a)}}function h(a){try{i(g.throw(a))}catch(a){b(a)}}function i(b){var d;b.done?a(b.value):((d=b.value)instanceof f?d:new f(function(a){a(d)})).then(c,h)}i((g=g.apply(d,e||[])).next())})}}let{PostgrestClient:D,PostgrestQueryBuilder:E,PostgrestFilterBuilder:F,PostgrestTransformBuilder:G,PostgrestBuilder:H,PostgrestError:I}=a.i(14504).default,J={"X-Client-Info":"realtime-js/2.11.2"};(c=m||(m={}))[c.connecting=0]="connecting",c[c.open=1]="open",c[c.closing=2]="closing",c[c.closed=3]="closed",(d=n||(n={})).closed="closed",d.errored="errored",d.joined="joined",d.joining="joining",d.leaving="leaving",(e=o||(o={})).close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token",(p||(p={})).websocket="websocket",(f=q||(q={})).Connecting="connecting",f.Open="open",f.Closing="closing",f.Closed="closed";class K{constructor(){this.HEADER_LENGTH=1}decode(a,b){return a.constructor===ArrayBuffer?b(this._binaryDecode(a)):"string"==typeof a?b(JSON.parse(a)):b({})}_binaryDecode(a){let b=new DataView(a),c=new TextDecoder;return this._decodeBroadcast(a,b,c)}_decodeBroadcast(a,b,c){let d=b.getUint8(1),e=b.getUint8(2),f=this.HEADER_LENGTH+2,g=c.decode(a.slice(f,f+d));f+=d;let h=c.decode(a.slice(f,f+e));return f+=e,{ref:null,topic:g,event:h,payload:JSON.parse(c.decode(a.slice(f,a.byteLength)))}}}class L{constructor(a,b){this.callback=a,this.timerCalc=b,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=b}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(g=r||(r={})).abstime="abstime",g.bool="bool",g.date="date",g.daterange="daterange",g.float4="float4",g.float8="float8",g.int2="int2",g.int4="int4",g.int4range="int4range",g.int8="int8",g.int8range="int8range",g.json="json",g.jsonb="jsonb",g.money="money",g.numeric="numeric",g.oid="oid",g.reltime="reltime",g.text="text",g.time="time",g.timestamp="timestamp",g.timestamptz="timestamptz",g.timetz="timetz",g.tsrange="tsrange",g.tstzrange="tstzrange";let M=(a,b,c={})=>{var d;let e=null!=(d=c.skipTypes)?d:[];return Object.keys(b).reduce((c,d)=>(c[d]=N(d,a,b,e),c),{})},N=(a,b,c,d)=>{let e=b.find(b=>b.name===a),f=null==e?void 0:e.type,g=c[a];return f&&!d.includes(f)?O(f,g):P(g)},O=(a,b)=>{if("_"===a.charAt(0))return T(b,a.slice(1,a.length));switch(a){case r.bool:return Q(b);case r.float4:case r.float8:case r.int2:case r.int4:case r.int8:case r.numeric:case r.oid:return R(b);case r.json:case r.jsonb:return S(b);case r.timestamp:return U(b);case r.abstime:case r.date:case r.daterange:case r.int4range:case r.int8range:case r.money:case r.reltime:case r.text:case r.time:case r.timestamptz:case r.timetz:case r.tsrange:case r.tstzrange:default:return P(b)}},P=a=>a,Q=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},R=a=>{if("string"==typeof a){let b=parseFloat(a);if(!Number.isNaN(b))return b}return a},S=a=>{if("string"==typeof a)try{return JSON.parse(a)}catch(a){console.log(`JSON parse error: ${a}`)}return a},T=(a,b)=>{if("string"!=typeof a)return a;let c=a.length-1,d=a[c];if("{"===a[0]&&"}"===d){let d,e=a.slice(1,c);try{d=JSON.parse("["+e+"]")}catch(a){d=e?e.split(","):[]}return d.map(a=>O(b,a))}return a},U=a=>"string"==typeof a?a.replace(" ","T"):a,V=a=>{let b=a;return(b=(b=b.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class W{constructor(a,b,c={},d=1e4){this.channel=a,this.event=b,this.payload=c,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,b){var c;return this._hasReceived(a)&&b(null==(c=this.receivedResp)?void 0:c.response),this.recHooks.push({status:a,callback:b}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let a=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,b){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:b})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:b}){this.recHooks.filter(b=>b.status===a).forEach(a=>a.callback(b))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}(h=s||(s={})).SYNC="sync",h.JOIN="join",h.LEAVE="leave";class X{constructor(a,b){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const c=(null==b?void 0:b.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(c.state,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=X.syncState(this.state,a,b,c),this.pendingDiffs.forEach(a=>{this.state=X.syncDiff(this.state,a,b,c)}),this.pendingDiffs=[],d()}),this.channel._on(c.diff,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=X.syncDiff(this.state,a,b,c),d())}),this.onJoin((a,b,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:b,newPresences:c})}),this.onLeave((a,b,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:b,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,b,c,d){let e=this.cloneDeep(a),f=this.transformState(b),g={},h={};return this.map(e,(a,b)=>{f[a]||(h[a]=b)}),this.map(f,(a,b)=>{let c=e[a];if(c){let d=b.map(a=>a.presence_ref),e=c.map(a=>a.presence_ref),f=b.filter(a=>0>e.indexOf(a.presence_ref)),i=c.filter(a=>0>d.indexOf(a.presence_ref));f.length>0&&(g[a]=f),i.length>0&&(h[a]=i)}else g[a]=b}),this.syncDiff(e,{joins:g,leaves:h},c,d)}static syncDiff(a,b,c,d){let{joins:e,leaves:f}={joins:this.transformState(b.joins),leaves:this.transformState(b.leaves)};return c||(c=()=>{}),d||(d=()=>{}),this.map(e,(b,d)=>{var e;let f=null!=(e=a[b])?e:[];if(a[b]=this.cloneDeep(d),f.length>0){let c=a[b].map(a=>a.presence_ref),d=f.filter(a=>0>c.indexOf(a.presence_ref));a[b].unshift(...d)}c(b,f,d)}),this.map(f,(b,c)=>{let e=a[b];if(!e)return;let f=c.map(a=>a.presence_ref);e=e.filter(a=>0>f.indexOf(a.presence_ref)),a[b]=e,d(b,e,c),0===e.length&&delete a[b]}),a}static map(a,b){return Object.getOwnPropertyNames(a).map(c=>b(c,a[c]))}static transformState(a){return Object.getOwnPropertyNames(a=this.cloneDeep(a)).reduce((b,c)=>{let d=a[c];return"metas"in d?b[c]=d.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):b[c]=d,b},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(i=t||(t={})).ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE",(j=u||(u={})).BROADCAST="broadcast",j.PRESENCE="presence",j.POSTGRES_CHANGES="postgres_changes",j.SYSTEM="system",(k=v||(v={})).SUBSCRIBED="SUBSCRIBED",k.TIMED_OUT="TIMED_OUT",k.CLOSED="CLOSED",k.CHANNEL_ERROR="CHANNEL_ERROR";class Y{constructor(a,b={config:{}},c){this.topic=a,this.params=b,this.socket=c,this.bindings={},this.state=n.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},b.config),this.timeout=this.socket.timeout,this.joinPush=new W(this,o.join,this.params,this.timeout),this.rejoinTimer=new L(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=n.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=n.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=n.errored,this.rejoinTimer.scheduleTimeout())}),this._on(o.reply,{},(a,b)=>{this._trigger(this._replyEventName(b),a)}),this.presence=new X(this),this.broadcastEndpointURL=V(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(a,b=this.timeout){var c,d;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:e,presence:f,private:g}}=this.params;this._onError(b=>null==a?void 0:a(v.CHANNEL_ERROR,b)),this._onClose(()=>null==a?void 0:a(v.CLOSED));let h={},i={broadcast:e,presence:f,postgres_changes:null!=(d=null==(c=this.bindings.postgres_changes)?void 0:c.map(a=>a.filter))?d:[],private:g};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:i},h)),this.joinedOnce=!0,this._rejoin(b),this.joinPush.receive("ok",async({postgres_changes:b})=>{var c;if(this.socket.setAuth(),void 0===b){null==a||a(v.SUBSCRIBED);return}{let d=this.bindings.postgres_changes,e=null!=(c=null==d?void 0:d.length)?c:0,f=[];for(let c=0;c<e;c++){let e=d[c],{filter:{event:g,schema:h,table:i,filter:j}}=e,k=b&&b[c];if(k&&k.event===g&&k.schema===h&&k.table===i&&k.filter===j)f.push(Object.assign(Object.assign({},e),{id:k.id}));else{this.unsubscribe(),null==a||a(v.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,a&&a(v.SUBSCRIBED);return}}).receive("error",b=>{null==a||a(v.CHANNEL_ERROR,Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{null==a||a(v.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,b={}){return await this.send({type:"presence",event:"track",payload:a},b.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,b,c){return this._on(a,b,c)}async send(a,b={}){var c,d;if(this._canPush()||"broadcast"!==a.type)return new Promise(c=>{var d,e,f;let g=this._push(a.type,a,b.timeout||this.timeout);"broadcast"!==a.type||(null==(f=null==(e=null==(d=this.params)?void 0:d.config)?void 0:e.broadcast)?void 0:f.ack)||c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))});{let{event:e,payload:f}=a,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:f,private:this.private}]})};try{let a=await this._fetchWithTimeout(this.broadcastEndpointURL,g,null!=(c=b.timeout)?c:this.timeout);return await (null==(d=a.body)?void 0:d.cancel()),a.ok?"ok":"error"}catch(a){if("AbortError"===a.name)return"timed out";return"error"}}}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=n.leaving;let b=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(o.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(c=>{let d=new W(this,o.leave,{},a);d.receive("ok",()=>{b(),c("ok")}).receive("timeout",()=>{b(),c("timed out")}).receive("error",()=>{c("error")}),d.send(),this._canPush()||d.trigger("ok",{})})}async _fetchWithTimeout(a,b,c){let d=new AbortController,e=setTimeout(()=>d.abort(),c),f=await this.socket.fetch(a,Object.assign(Object.assign({},b),{signal:d.signal}));return clearTimeout(e),f}_push(a,b,c=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new W(this,a,b,c);return this._canPush()?d.send():(d.startTimeout(),this.pushBuffer.push(d)),d}_onMessage(a,b,c){return b}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,b,c){var d,e;let f=a.toLocaleLowerCase(),{close:g,error:h,leave:i,join:j}=o;if(c&&[g,h,i,j].indexOf(f)>=0&&c!==this._joinRef())return;let k=this._onMessage(f,b,c);if(b&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?null==(d=this.bindings.postgres_changes)||d.filter(a=>{var b,c,d;return(null==(b=a.filter)?void 0:b.event)==="*"||(null==(d=null==(c=a.filter)?void 0:c.event)?void 0:d.toLocaleLowerCase())===f}).map(a=>a.callback(k,c)):null==(e=this.bindings[f])||e.filter(a=>{var c,d,e,g,h,i;if(!["broadcast","presence","postgres_changes"].includes(f))return a.type.toLocaleLowerCase()===f;if("id"in a){let f=a.id,g=null==(c=a.filter)?void 0:c.event;return f&&(null==(d=b.ids)?void 0:d.includes(f))&&("*"===g||(null==g?void 0:g.toLocaleLowerCase())===(null==(e=b.data)?void 0:e.type.toLocaleLowerCase()))}{let c=null==(h=null==(g=null==a?void 0:a.filter)?void 0:g.event)?void 0:h.toLocaleLowerCase();return"*"===c||c===(null==(i=null==b?void 0:b.event)?void 0:i.toLocaleLowerCase())}}).map(a=>{if("object"==typeof k&&"ids"in k){let a=k.data,{schema:b,table:c,commit_timestamp:d,type:e,errors:f}=a;k=Object.assign(Object.assign({},{schema:b,table:c,commit_timestamp:d,eventType:e,new:{},old:{},errors:f}),this._getPayloadRecords(a))}a.callback(k,c)})}_isClosed(){return this.state===n.closed}_isJoined(){return this.state===n.joined}_isJoining(){return this.state===n.joining}_isLeaving(){return this.state===n.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,b,c){let d=a.toLocaleLowerCase(),e={type:d,filter:b,callback:c};return this.bindings[d]?this.bindings[d].push(e):this.bindings[d]=[e],this}_off(a,b){let c=a.toLocaleLowerCase();return this.bindings[c]=this.bindings[c].filter(a=>{var d;return!((null==(d=a.type)?void 0:d.toLocaleLowerCase())===c&&Y.isEqual(a.filter,b))}),this}static isEqual(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(a[c]!==b[c])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(o.close,{},a)}_onError(a){this._on(o.error,{},b=>a(b))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=n.joining,this.joinPush.resend(a))}_getPayloadRecords(a){let b={new:{},old:{}};return("INSERT"===a.type||"UPDATE"===a.type)&&(b.new=M(a.columns,a.record)),("UPDATE"===a.type||"DELETE"===a.type)&&(b.old=M(a.columns,a.old_record)),b}}let Z=()=>{},$="undefined"!=typeof WebSocket,_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class aa{constructor(b,c){var d;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=J,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Z,this.conn=null,this.sendBuffer=[],this.serializer=new K,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(16407).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)},this.endPoint=`${b}/${p.websocket}`,this.httpEndpoint=V(b),(null==c?void 0:c.transport)?this.transport=c.transport:this.transport=null,(null==c?void 0:c.params)&&(this.params=c.params),(null==c?void 0:c.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),c.headers)),(null==c?void 0:c.timeout)&&(this.timeout=c.timeout),(null==c?void 0:c.logger)&&(this.logger=c.logger),(null==c?void 0:c.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=c.heartbeatIntervalMs);const e=null==(d=null==c?void 0:c.params)?void 0:d.apikey;e&&(this.accessTokenValue=e,this.apiKey=e),this.reconnectAfterMs=(null==c?void 0:c.reconnectAfterMs)?c.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=(null==c?void 0:c.encode)?c.encode:(a,b)=>b(JSON.stringify(a)),this.decode=(null==c?void 0:c.decode)?c.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new L(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==c?void 0:c.fetch),(null==c?void 0:c.worker)&&(this.worker=(null==c?void 0:c.worker)||!1,this.workerUrl=null==c?void 0:c.workerUrl),this.accessToken=(null==c?void 0:c.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if($){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new ab(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),a.A(87641).then(({default:a})=>{this.conn=new a(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(a,b){this.conn&&(this.conn.onclose=function(){},a?this.conn.close(a,null!=b?b:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(a){let b=await a.unsubscribe();return 0===this.channels.length&&this.disconnect(),b}async removeAllChannels(){let a=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.disconnect(),a}log(a,b,c){this.logger(a,b,c)}connectionState(){switch(this.conn&&this.conn.readyState){case m.connecting:return q.Connecting;case m.open:return q.Open;case m.closing:return q.Closing;default:return q.Closed}}isConnected(){return this.connectionState()===q.Open}channel(a,b={config:{}}){let c=new Y(`realtime:${a}`,b,this);return this.channels.push(c),c}push(a){let{topic:b,event:c,payload:d,ref:e}=a,f=()=>{this.encode(a,a=>{var b;null==(b=this.conn)||b.send(a)})};this.log("push",`${b} ${c} (${e})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){let b=a||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(b){let a=null;try{a=JSON.parse(atob(b.split(".")[1]))}catch(a){}if(a&&a.exp&&!(Math.floor(Date.now()/1e3)-a.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${a.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${a.exp}`);this.accessTokenValue=b,this.channels.forEach(a=>{b&&a.updateJoinPayload({access_token:b}),a.joinedOnce&&a._isJoined()&&a._push(o.access_token,{access_token:b})})}}async sendHeartbeat(){var a;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null==(a=this.conn)||a.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let b=this.channels.find(b=>b.topic===a&&(b._isJoined()||b._isJoining()));b&&(this.log("transport",`leaving duplicate topic "${a}"`),b.unsubscribe())}_remove(a){this.channels=this.channels.filter(b=>b._joinRef()!==a._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_onConnMessage(a){this.decode(a.data,a=>{let{topic:b,event:c,payload:d,ref:e}=a;e&&e===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${d.status||""} ${b} ${c} ${e&&"("+e+")"||""}`,d),this.channels.filter(a=>a._isMember(b)).forEach(a=>a._trigger(c,d,e)),this.stateChangeCallbacks.message.forEach(b=>b(a))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{"keepAlive"===a.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(a=>a())}_onConnClose(a){this.log("transport","close",a),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(b=>b(a))}_onConnError(a){this.log("transport",a.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(b=>b(a))}_triggerChanError(){this.channels.forEach(a=>a._trigger(o.error))}_appendParams(a,b){if(0===Object.keys(b).length)return a;let c=a.match(/\?/)?"&":"?",d=new URLSearchParams(b);return`${a}${c}${d}`}_workerObjectUrl(a){let b;if(a)b=a;else{let a=new Blob([_],{type:"application/javascript"});b=URL.createObjectURL(a)}return b}}class ab{constructor(a,b,c){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=m.connecting,this.send=()=>{},this.url=null,this.url=a,this.close=c.close}}class ac extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function ad(a){return"object"==typeof a&&null!==a&&"__isStorageError"in a}class ae extends ac{constructor(a,b){super(a),this.name="StorageApiError",this.status=b}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class af extends ac{constructor(a,b){super(a),this.name="StorageUnknownError",this.originalError=b}}let ag=b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(16407).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)},ah=a=>{if(Array.isArray(a))return a.map(a=>ah(a));if("function"==typeof a||a!==Object(a))return a;let b={};return Object.entries(a).forEach(([a,c])=>{b[a.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""))]=ah(c)}),b};var ai=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})};let aj=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a);function ak(b,c,d,e,f,g){return ai(this,void 0,void 0,function*(){return new Promise((h,i)=>{let j;b(d,(j={method:c,headers:(null==e?void 0:e.headers)||{}},"GET"===c?j:(j.headers=Object.assign({"Content-Type":"application/json"},null==e?void 0:e.headers),g&&(j.body=JSON.stringify(g)),Object.assign(Object.assign({},j),f)))).then(a=>{if(!a.ok)throw a;return(null==e?void 0:e.noResolveJson)?a:a.json()}).then(a=>h(a)).catch(b=>ai(void 0,void 0,void 0,function*(){var c,d,f,g;let h=yield(c=void 0,d=void 0,f=void 0,g=function*(){return"undefined"==typeof Response?(yield a.A(16407)).Response:Response},new(f||(f=Promise))(function(a,b){function e(a){try{i(g.next(a))}catch(a){b(a)}}function h(a){try{i(g.throw(a))}catch(a){b(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof f?c:new f(function(a){a(c)})).then(e,h)}i((g=g.apply(c,d||[])).next())}));b instanceof h&&!(null==e?void 0:e.noResolveJson)?b.json().then(a=>{i(new ae(aj(a),b.status||500))}).catch(a=>{i(new af(aj(a),a))}):i(new af(aj(b),b))}))})})}function al(a,b,c,d){return ai(this,void 0,void 0,function*(){return ak(a,"GET",b,c,d)})}function am(a,b,c,d,e){return ai(this,void 0,void 0,function*(){return ak(a,"POST",b,d,e,c)})}function an(a,b,c,d,e){return ai(this,void 0,void 0,function*(){return ak(a,"DELETE",b,d,e,c)})}var ao=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})};let ap={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},aq={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ar{constructor(a,b={},c,d){this.url=a,this.headers=b,this.bucketId=c,this.fetch=ag(d)}uploadOrUpdate(a,b,c,d){return ao(this,void 0,void 0,function*(){try{let e,f=Object.assign(Object.assign({},aq),d),g=Object.assign(Object.assign({},this.headers),"POST"===a&&{"x-upsert":String(f.upsert)}),h=f.metadata;"undefined"!=typeof Blob&&c instanceof Blob?((e=new FormData).append("cacheControl",f.cacheControl),h&&e.append("metadata",this.encodeMetadata(h)),e.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?((e=c).append("cacheControl",f.cacheControl),h&&e.append("metadata",this.encodeMetadata(h))):(e=c,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,h&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),(null==d?void 0:d.headers)&&(g=Object.assign(Object.assign({},g),d.headers));let i=this._removeEmptyFolders(b),j=this._getFinalPath(i),k=yield this.fetch(`${this.url}/object/${j}`,Object.assign({method:a,body:e,headers:g},(null==f?void 0:f.duplex)?{duplex:f.duplex}:{})),l=yield k.json();if(k.ok)return{data:{path:i,id:l.Id,fullPath:l.Key},error:null};return{data:null,error:l}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}upload(a,b,c){return ao(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,b,c)})}uploadToSignedUrl(a,b,c,d){return ao(this,void 0,void 0,function*(){let e=this._removeEmptyFolders(a),f=this._getFinalPath(e),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",b);try{let a,b=Object.assign({upsert:aq.upsert},d),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(b.upsert)});"undefined"!=typeof Blob&&c instanceof Blob?((a=new FormData).append("cacheControl",b.cacheControl),a.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?(a=c).append("cacheControl",b.cacheControl):(a=c,f["cache-control"]=`max-age=${b.cacheControl}`,f["content-type"]=b.contentType);let h=yield this.fetch(g.toString(),{method:"PUT",body:a,headers:f}),i=yield h.json();if(h.ok)return{data:{path:e,fullPath:i.Key},error:null};return{data:null,error:i}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(a,b){return ao(this,void 0,void 0,function*(){try{let c=this._getFinalPath(a),d=Object.assign({},this.headers);(null==b?void 0:b.upsert)&&(d["x-upsert"]="true");let e=yield am(this.fetch,`${this.url}/object/upload/sign/${c}`,{},{headers:d}),f=new URL(this.url+e.url),g=f.searchParams.get("token");if(!g)throw new ac("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}update(a,b,c){return ao(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,b,c)})}move(a,b,c){return ao(this,void 0,void 0,function*(){try{return{data:yield am(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}copy(a,b,c){return ao(this,void 0,void 0,function*(){try{return{data:{path:(yield am(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}createSignedUrl(a,b,c){return ao(this,void 0,void 0,function*(){try{let d=this._getFinalPath(a),e=yield am(this.fetch,`${this.url}/object/sign/${d}`,Object.assign({expiresIn:b},(null==c?void 0:c.transform)?{transform:c.transform}:{}),{headers:this.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:e={signedUrl:encodeURI(`${this.url}${e.signedURL}${f}`)},error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}createSignedUrls(a,b,c){return ao(this,void 0,void 0,function*(){try{let d=yield am(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:b,paths:a},{headers:this.headers}),e=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:d.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${e}`):null})),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}download(a,b){return ao(this,void 0,void 0,function*(){let c=void 0!==(null==b?void 0:b.transform),d=this.transformOptsToQueryString((null==b?void 0:b.transform)||{}),e=d?`?${d}`:"";try{let b=this._getFinalPath(a),d=yield al(this.fetch,`${this.url}/${c?"render/image/authenticated":"object"}/${b}${e}`,{headers:this.headers,noResolveJson:!0});return{data:yield d.blob(),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}info(a){return ao(this,void 0,void 0,function*(){let b=this._getFinalPath(a);try{let a=yield al(this.fetch,`${this.url}/object/info/${b}`,{headers:this.headers});return{data:ah(a),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}exists(a){return ao(this,void 0,void 0,function*(){let b=this._getFinalPath(a);try{return yield function(a,b,c,d){return ai(this,void 0,void 0,function*(){return ak(a,"HEAD",b,Object.assign(Object.assign({},c),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${b}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(ad(a)&&a instanceof af){let b=a.originalError;if([400,404].includes(null==b?void 0:b.status))return{data:!1,error:a}}throw a}})}getPublicUrl(a,b){let c=this._getFinalPath(a),d=[],e=(null==b?void 0:b.download)?`download=${!0===b.download?"":b.download}`:"";""!==e&&d.push(e);let f=void 0!==(null==b?void 0:b.transform),g=this.transformOptsToQueryString((null==b?void 0:b.transform)||{});""!==g&&d.push(g);let h=d.join("&");return""!==h&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f?"render/image":"object"}/public/${c}${h}`)}}}remove(a){return ao(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}list(a,b,c){return ao(this,void 0,void 0,function*(){try{let d=Object.assign(Object.assign(Object.assign({},ap),b),{prefix:a||""});return{data:yield am(this.fetch,`${this.url}/object/list/${this.bucketId}`,d,{headers:this.headers},c),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return"undefined"!=typeof Buffer?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){let b=[];return a.width&&b.push(`width=${a.width}`),a.height&&b.push(`height=${a.height}`),a.resize&&b.push(`resize=${a.resize}`),a.format&&b.push(`format=${a.format}`),a.quality&&b.push(`quality=${a.quality}`),b.join("&")}}let as={"X-Client-Info":"storage-js/2.7.1"};var at=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})};class au{constructor(a,b={},c){this.url=a,this.headers=Object.assign(Object.assign({},as),b),this.fetch=ag(c)}listBuckets(){return at(this,void 0,void 0,function*(){try{return{data:yield al(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}getBucket(a){return at(this,void 0,void 0,function*(){try{return{data:yield al(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}createBucket(a,b={public:!1}){return at(this,void 0,void 0,function*(){try{return{data:yield am(this.fetch,`${this.url}/bucket`,{id:a,name:a,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}updateBucket(a,b){return at(this,void 0,void 0,function*(){try{return{data:yield function(a,b,c,d,e){return ai(this,void 0,void 0,function*(){return ak(a,"PUT",b,d,void 0,c)})}(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}emptyBucket(a){return at(this,void 0,void 0,function*(){try{return{data:yield am(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}deleteBucket(a){return at(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(a){if(ad(a))return{data:null,error:a};throw a}})}}class av extends au{constructor(a,b={},c){super(a,b,c)}from(a){return new ar(this.url,this.headers,a,this.fetch)}}let aw="";aw="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let ax={headers:{"X-Client-Info":`supabase-js-${aw}/2.49.4`}},ay={schema:"public"},az={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},aA={};var aB=a.i(89431);let aC="2.69.1",aD={"X-Client-Info":`gotrue-js/${aC}`},aE="X-Supabase-Api-Version",aF={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},aG=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class aH extends Error{constructor(a,b,c){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=b,this.code=c}}function aI(a){return"object"==typeof a&&null!==a&&"__isAuthError"in a}class aJ extends aH{constructor(a,b,c){super(a,b,c),this.name="AuthApiError",this.status=b,this.code=c}}class aK extends aH{constructor(a,b){super(a),this.name="AuthUnknownError",this.originalError=b}}class aL extends aH{constructor(a,b,c,d){super(a,c,d),this.name=b,this.status=c}}class aM extends aL{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class aN extends aL{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class aO extends aL{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class aP extends aL{constructor(a,b=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=b}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class aQ extends aL{constructor(a,b){super(a,"AuthRetryableFetchError",b,void 0)}}function aR(a){return aI(a)&&"AuthRetryableFetchError"===a.name}class aS extends aL{constructor(a,b,c){super(a,"AuthWeakPasswordError",b,"weak_password"),this.reasons=c}}class aT extends aL{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}let aU="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),aV=" 	\n\r=".split(""),aW=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<aV.length;b+=1)a[aV[b].charCodeAt(0)]=-2;for(let b=0;b<aU.length;b+=1)a[aU[b].charCodeAt(0)]=b;return a})();function aX(a,b,c){let d=aW[a];if(d>-1)for(b.queue=b.queue<<6|d,b.queuedBits+=6;b.queuedBits>=8;)c(b.queue>>b.queuedBits-8&255),b.queuedBits-=8;else if(-2===d)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}function aY(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e={queue:0,queuedBits:0},f=a=>{!function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}}(a,d,c)};for(let b=0;b<a.length;b+=1)aX(a.charCodeAt(b),e,f);return b.join("")}let aZ=b=>{let c;return c=b||("undefined"==typeof fetch?(...b)=>a.A(16407).then(({default:a})=>a(...b)):fetch),(...a)=>c(...a)},a$=async(a,b,c)=>{await a.setItem(b,JSON.stringify(c))},a_=async(a,b)=>{let c=await a.getItem(b);if(!c)return null;try{return JSON.parse(c)}catch(a){return c}},a0=async(a,b)=>{await a.removeItem(b)};class a1{constructor(){this.promise=new a1.promiseConstructor((a,b)=>{this.resolve=a,this.reject=b})}}function a2(a){let b=a.split(".");if(3!==b.length)throw new aT("Invalid JWT structure");for(let a=0;a<b.length;a++)if(!aG.test(b[a]))throw new aT("JWT not in base64url format");return{header:JSON.parse(aY(b[0])),payload:JSON.parse(aY(b[1])),signature:function(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};for(let b=0;b<a.length;b+=1)aX(a.charCodeAt(b),c,d);return new Uint8Array(b)}(b[2]),raw:{header:b[0],payload:b[1]}}}async function a3(a){return await new Promise(b=>{setTimeout(()=>b(null),a)})}function a4(a){return("0"+a.toString(16)).substr(-2)}async function a5(a){let b=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>String.fromCharCode(a)).join("")}async function a6(a){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a):btoa(await a5(a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function a7(a,b,c=!1){let d=function(){let a=new Uint32Array(56);if("undefined"==typeof crypto){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",b=a.length,c="";for(let d=0;d<56;d++)c+=a.charAt(Math.floor(Math.random()*b));return c}return crypto.getRandomValues(a),Array.from(a,a4).join("")}(),e=d;c&&(e+="/PASSWORD_RECOVERY"),await a$(a,`${b}-code-verifier`,e);let f=await a6(d),g=d===f?"plain":"s256";return[f,g]}a1.promiseConstructor=Promise;let a8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;var a9=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};let ba=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),bb=[502,503,504];async function bc(a){var b;let c,d;if(!("object"==typeof a&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"==typeof a.json))throw new aQ(ba(a),0);if(bb.includes(a.status))throw new aQ(ba(a),a.status);try{c=await a.json()}catch(a){throw new aK(ba(a),a)}let e=function(a){let b=a.headers.get(aE);if(!b||!b.match(a8))return null;try{return new Date(`${b}T00:00:00.0Z`)}catch(a){return null}}(a);if(e&&e.getTime()>=aF["2024-01-01"].timestamp&&"object"==typeof c&&c&&"string"==typeof c.code?d=c.code:"object"==typeof c&&c&&"string"==typeof c.error_code&&(d=c.error_code),d){if("weak_password"===d)throw new aS(ba(c),a.status,(null==(b=c.weak_password)?void 0:b.reasons)||[]);else if("session_not_found"===d)throw new aM}else if("object"==typeof c&&c&&"object"==typeof c.weak_password&&c.weak_password&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0))throw new aS(ba(c),a.status,c.weak_password.reasons);throw new aJ(ba(c),a.status||500,d)}async function bd(a,b,c,d){var e;let f=Object.assign({},null==d?void 0:d.headers);f[aE]||(f[aE]=aF["2024-01-01"].name),(null==d?void 0:d.jwt)&&(f.Authorization=`Bearer ${d.jwt}`);let g=null!=(e=null==d?void 0:d.query)?e:{};(null==d?void 0:d.redirectTo)&&(g.redirect_to=d.redirectTo);let h=Object.keys(g).length?"?"+new URLSearchParams(g).toString():"",i=await be(a,b,c+h,{headers:f,noResolveJson:null==d?void 0:d.noResolveJson},{},null==d?void 0:d.body);return(null==d?void 0:d.xform)?null==d?void 0:d.xform(i):{data:Object.assign({},i),error:null}}async function be(a,b,c,d,e,f){let g,h,i=(h={method:b,headers:(null==d?void 0:d.headers)||{}},"GET"===b?h:(h.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==d?void 0:d.headers),h.body=JSON.stringify(f),Object.assign(Object.assign({},h),e)));try{g=await a(c,Object.assign({},i))}catch(a){throw console.error(a),new aQ(ba(a),0)}if(g.ok||await bc(g),null==d?void 0:d.noResolveJson)return g;try{return await g.json()}catch(a){await bc(a)}}function bf(a){var b,c,d;let e=null;(d=a).access_token&&d.refresh_token&&d.expires_in&&(e=Object.assign({},a),a.expires_at||(e.expires_at=(c=a.expires_in,Math.round(Date.now()/1e3)+c)));return{data:{session:e,user:null!=(b=a.user)?b:a},error:null}}function bg(a){let b=bf(a);return!b.error&&a.weak_password&&"object"==typeof a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&"string"==typeof a.weak_password.message&&a.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0)&&(b.data.weak_password=a.weak_password),b}function bh(a){var b;return{data:{user:null!=(b=a.user)?b:a},error:null}}function bi(a){return{data:a,error:null}}function bj(a){let{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f}=a;return{data:{properties:{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f},user:Object.assign({},a9(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function bk(a){return a}var bl=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c};class bm{constructor({url:a="",headers:b={},fetch:c}){this.url=a,this.headers=b,this.fetch=aZ(c),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(a,b="global"){try{return await bd(this.fetch,"POST",`${this.url}/logout?scope=${b}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(a){if(aI(a))return{data:null,error:a};throw a}}async inviteUserByEmail(a,b={}){try{return await bd(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:b.data},headers:this.headers,redirectTo:b.redirectTo,xform:bh})}catch(a){if(aI(a))return{data:{user:null},error:a};throw a}}async generateLink(a){try{let{options:b}=a,c=bl(a,["options"]),d=Object.assign(Object.assign({},c),b);return"newEmail"in c&&(d.new_email=null==c?void 0:c.newEmail,delete d.newEmail),await bd(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:bj,redirectTo:null==b?void 0:b.redirectTo})}catch(a){if(aI(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(a){try{return await bd(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:bh})}catch(a){if(aI(a))return{data:{user:null},error:a};throw a}}async listUsers(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await bd(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:bk});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(aI(a))return{data:{users:[]},error:a};throw a}}async getUserById(a){try{return await bd(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:bh})}catch(a){if(aI(a))return{data:{user:null},error:a};throw a}}async updateUserById(a,b){try{return await bd(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:b,headers:this.headers,xform:bh})}catch(a){if(aI(a))return{data:{user:null},error:a};throw a}}async deleteUser(a,b=!1){try{return await bd(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:b},xform:bh})}catch(a){if(aI(a))return{data:{user:null},error:a};throw a}}async _listFactors(a){try{let{data:b,error:c}=await bd(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:b,error:c}}catch(a){if(aI(a))return{data:null,error:a};throw a}}async _deleteFactor(a){try{return{data:await bd(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(a){if(aI(a))return{data:null,error:a};throw a}}}let bn={getItem:a=>null,setItem:(a,b)=>{},removeItem:a=>{}};function bo(a={}){return{getItem:b=>a[b]||null,setItem:(b,c)=>{a[b]=c},removeItem:b=>{delete a[b]}}}globalThis;class bp extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(a){"undefined"!=typeof self&&(self.globalThis=self)}let bq={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function br(a,b,c){return await c()}class bs{constructor(a){this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=bs.nextInstanceID,bs.nextInstanceID+=1,this.instanceID;const b=Object.assign(Object.assign({},bq),a);this.logDebugMessages=!!b.debug,"function"==typeof b.debug&&(this.logger=b.debug),this.persistSession=b.persistSession,this.storageKey=b.storageKey,this.autoRefreshToken=b.autoRefreshToken,this.admin=new bm({url:b.url,headers:b.headers,fetch:b.fetch}),this.url=b.url,this.headers=b.headers,this.fetch=aZ(b.fetch),this.lock=b.lock||br,this.detectSessionInUrl=b.detectSessionInUrl,this.flowType=b.flowType,this.hasCustomAuthorizationHeader=b.hasCustomAuthorizationHeader,b.lock?this.lock=b.lock:this.lock=br,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?b.storage?this.storage=b.storage:(this.memoryStorage={},this.storage=bo(this.memoryStorage)):(this.memoryStorage={},this.storage=bo(this.memoryStorage)),this.initialize()}_debug(...a){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${aC}) ${new Date().toISOString()}`,...a),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{let a=function(a){let b={},c=new URL(a);if(c.hash&&"#"===c.hash[0])try{new URLSearchParams(c.hash.substring(1)).forEach((a,c)=>{b[c]=a})}catch(a){}return c.searchParams.forEach((a,c)=>{b[c]=a}),b}(window.location.href);return this._isImplicitGrantCallback(a)||await this._isPKCECallback(a),await this._recoverAndRefresh(),{error:null}}catch(a){if(aI(a))return{error:a};return{error:new aK("Unexpected error during initialization",a)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var b,c,d;try{let{data:e,error:f}=await bd(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(c=null==(b=null==a?void 0:a.options)?void 0:b.data)?c:{},gotrue_meta_security:{captcha_token:null==(d=null==a?void 0:a.options)?void 0:d.captchaToken}},xform:bf});if(f||!e)return{data:{user:null,session:null},error:f};let g=e.session,h=e.user;return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:h,session:g},error:null}}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(a){var b,c,d;try{let e;if("email"in a){let{email:c,password:d,options:f}=a,g=null,h=null;"pkce"===this.flowType&&([g,h]=await a7(this.storage,this.storageKey)),e=await bd(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==f?void 0:f.emailRedirectTo,body:{email:c,password:d,data:null!=(b=null==f?void 0:f.data)?b:{},gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken},code_challenge:g,code_challenge_method:h},xform:bf})}else if("phone"in a){let{phone:b,password:f,options:g}=a;e=await bd(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:f,data:null!=(c=null==g?void 0:g.data)?c:{},channel:null!=(d=null==g?void 0:g.channel)?d:"sms",gotrue_meta_security:{captcha_token:null==g?void 0:g.captchaToken}},xform:bf})}else throw new aO("You must provide either an email or phone number and a password");let{data:f,error:g}=e;if(g||!f)return{data:{user:null,session:null},error:g};let h=f.session,i=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:i,session:h},error:null}}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(a){try{let b;if("email"in a){let{email:c,password:d,options:e}=a;b=await bd(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:bg})}else if("phone"in a){let{phone:c,password:d,options:e}=a;b=await bd(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:bg})}else throw new aO("You must provide either an email or phone number and a password");let{data:c,error:d}=b;if(d)return{data:{user:null,session:null},error:d};if(!c||!c.session||!c.user)return{data:{user:null,session:null},error:new aN};return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign({user:c.user,session:c.session},c.weak_password?{weakPassword:c.weak_password}:null),error:d}}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(a){var b,c,d,e;return await this._handleProviderSignIn(a.provider,{redirectTo:null==(b=a.options)?void 0:b.redirectTo,scopes:null==(c=a.options)?void 0:c.scopes,queryParams:null==(d=a.options)?void 0:d.queryParams,skipBrowserRedirect:null==(e=a.options)?void 0:e.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async _exchangeCodeForSession(a){let b=await a_(this.storage,`${this.storageKey}-code-verifier`),[c,d]=(null!=b?b:"").split("/");try{let{data:b,error:e}=await bd(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:c},xform:bf});if(await a0(this.storage,`${this.storageKey}-code-verifier`),e)throw e;if(!b||!b.session||!b.user)return{data:{user:null,session:null,redirectType:null},error:new aN};return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign(Object.assign({},b),{redirectType:null!=d?d:null}),error:e}}catch(a){if(aI(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(a){try{let{options:b,provider:c,token:d,access_token:e,nonce:f}=a,{data:g,error:h}=await bd(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:c,id_token:d,access_token:e,nonce:f,gotrue_meta_security:{captcha_token:null==b?void 0:b.captchaToken}},xform:bf});if(h)return{data:{user:null,session:null},error:h};if(!g||!g.session||!g.user)return{data:{user:null,session:null},error:new aN};return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:h}}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(a){var b,c,d,e,f;try{if("email"in a){let{email:d,options:e}=a,f=null,g=null;"pkce"===this.flowType&&([f,g]=await a7(this.storage,this.storageKey));let{error:h}=await bd(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:null!=(b=null==e?void 0:e.data)?b:{},create_user:null==(c=null==e?void 0:e.shouldCreateUser)||c,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:null==e?void 0:e.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in a){let{phone:b,options:c}=a,{data:g,error:h}=await bd(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:null!=(d=null==c?void 0:c.data)?d:{},create_user:null==(e=null==c?void 0:c.shouldCreateUser)||e,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},channel:null!=(f=null==c?void 0:c.channel)?f:"sms"}});return{data:{user:null,session:null,messageId:null==g?void 0:g.message_id},error:h}}throw new aO("You must provide either an email or phone number.")}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(a){var b,c;try{let d,e;"options"in a&&(d=null==(b=a.options)?void 0:b.redirectTo,e=null==(c=a.options)?void 0:c.captchaToken);let{data:f,error:g}=await bd(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:e}}),redirectTo:d,xform:bf});if(g)throw g;if(!f)throw Error("An error occurred on token verification.");let h=f.session,i=f.user;return(null==h?void 0:h.access_token)&&(await this._saveSession(h),await this._notifyAllSubscribers("recovery"==a.type?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:i,session:h},error:null}}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(a){var b,c,d;try{let e=null,f=null;return"pkce"===this.flowType&&([e,f]=await a7(this.storage,this.storageKey)),await bd(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:null!=(c=null==(b=a.options)?void 0:b.redirectTo)?c:void 0}),(null==(d=null==a?void 0:a.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:e,code_challenge_method:f}),headers:this.headers,xform:bi})}catch(a){if(aI(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;if(c)throw c;if(!b)throw new aM;let{error:d}=await bd(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:b.access_token});return{data:{user:null,session:null},error:d}})}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async resend(a){try{let b=`${this.url}/resend`;if("email"in a){let{email:c,type:d,options:e}=a,{error:f}=await bd(this.fetch,"POST",b,{headers:this.headers,body:{email:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},redirectTo:null==e?void 0:e.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in a){let{phone:c,type:d,options:e}=a,{data:f,error:g}=await bd(this.fetch,"POST",b,{headers:this.headers,body:{phone:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}}});return{data:{user:null,session:null,messageId:null==f?void 0:f.message_id},error:g}}throw new aO("You must provide either an email or phone number and a type")}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(a,b){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){let a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await a,await b()))();return this.pendingInLock.push((async()=>{try{await c}catch(a){}})()),c}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let a=b();for(this.pendingInLock.push((async()=>{try{await a}catch(a){}})()),await a;this.pendingInLock.length;){let a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{let b=await this.__loadSession();return await a(b)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let a=null,b=await a_(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",b),null!==b&&(this._isValidSession(b)?a=b:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};let c=!!a.expires_at&&1e3*a.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${c?"":" not"} expired`,"expires_at",a.expires_at),!c){if(this.storage.isServer){let b=this.suppressGetSessionWarning;a=new Proxy(a,{get:(a,c,d)=>(b||"user"!==c||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),b=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,c,d))})}return{data:{session:a},error:null}}let{session:d,error:e}=await this._callRefreshToken(a.refresh_token);if(e)return{data:{session:null},error:e};return{data:{session:d},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{if(a)return await bd(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:bh});return await this._useSession(async a=>{var b,c,d;let{data:e,error:f}=a;if(f)throw f;return(null==(b=e.session)?void 0:b.access_token)||this.hasCustomAuthorizationHeader?await bd(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0,xform:bh}):{data:{user:null},error:new aM}})}catch(a){if(aI(a))return aI(a)&&"AuthSessionMissingError"===a.name&&(await this._removeSession(),await a0(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:a};throw a}}async updateUser(a,b={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,b))}async _updateUser(a,b={}){try{return await this._useSession(async c=>{let{data:d,error:e}=c;if(e)throw e;if(!d.session)throw new aM;let f=d.session,g=null,h=null;"pkce"===this.flowType&&null!=a.email&&([g,h]=await a7(this.storage,this.storageKey));let{data:i,error:j}=await bd(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==b?void 0:b.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:h}),jwt:f.access_token,xform:bh});if(j)throw j;return f.user=i.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(a){if(aI(a))return{data:{user:null},error:a};throw a}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new aM;let b=Date.now()/1e3,c=b,d=!0,e=null,{payload:f}=a2(a.access_token);if(f.exp&&(d=(c=f.exp)<=b),d){let{session:b,error:c}=await this._callRefreshToken(a.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!b)return{data:{user:null,session:null},error:null};e=b}else{let{data:d,error:f}=await this._getUser(a.access_token);if(f)throw f;e={access_token:a.access_token,refresh_token:a.refresh_token,user:d.user,token_type:"bearer",expires_in:c-b,expires_at:c},await this._saveSession(e),await this._notifyAllSubscribers("SIGNED_IN",e)}return{data:{user:e.user,session:e},error:null}}catch(a){if(aI(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async b=>{var c;if(!a){let{data:d,error:e}=b;if(e)throw e;a=null!=(c=d.session)?c:void 0}if(!(null==a?void 0:a.refresh_token))throw new aM;let{session:d,error:e}=await this._callRefreshToken(a.refresh_token);return e?{data:{user:null,session:null},error:e}:d?{data:{user:d.user,session:d},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(aI(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(a,b){try{throw new aP("No browser detected.")}catch(a){if(aI(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){let b=await a_(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&b)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return{error:e};let f=null==(c=d.session)?void 0:c.access_token;if(f){let{error:b}=await this.admin.signOut(f,a);if(b&&!(aI(b)&&"AuthApiError"===b.name&&(404===b.status||401===b.status||403===b.status)))return{error:b}}return"others"!==a&&(await this._removeSession(),await a0(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(a){let b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){let b=16*Math.random()|0;return("x"==a?b:3&b|8).toString(16)}),c={id:b,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",b),this.stateChangeEmitters.delete(b)}};return this._debug("#onAuthStateChange()","registered callback with id",b),this.stateChangeEmitters.set(b,c),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(b)})})(),{data:{subscription:c}}}async _emitInitialSession(a){return await this._useSession(async b=>{var c,d;try{let{data:{session:d},error:e}=b;if(e)throw e;await (null==(c=this.stateChangeEmitters.get(a))?void 0:c.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(b){await (null==(d=this.stateChangeEmitters.get(a))?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",b),console.error(b)}})}async resetPasswordForEmail(a,b={}){let c=null,d=null;"pkce"===this.flowType&&([c,d]=await a7(this.storage,this.storageKey,!0));try{return await bd(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:c,code_challenge_method:d,gotrue_meta_security:{captcha_token:b.captchaToken}},headers:this.headers,redirectTo:b.redirectTo})}catch(a){if(aI(a))return{data:null,error:a};throw a}}async getUserIdentities(){var a;try{let{data:b,error:c}=await this.getUser();if(c)throw c;return{data:{identities:null!=(a=b.user.identities)?a:[]},error:null}}catch(a){if(aI(a))return{data:null,error:a};throw a}}async linkIdentity(a){try{let{data:b,error:c}=await this._useSession(async b=>{var c,d,e,f,g;let{data:h,error:i}=b;if(i)throw i;let j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:null==(c=a.options)?void 0:c.redirectTo,scopes:null==(d=a.options)?void 0:d.scopes,queryParams:null==(e=a.options)?void 0:e.queryParams,skipBrowserRedirect:!0});return await bd(this.fetch,"GET",j,{headers:this.headers,jwt:null!=(g=null==(f=h.session)?void 0:f.access_token)?g:void 0})});if(c)throw c;return{data:{provider:a.provider,url:null==b?void 0:b.url},error:null}}catch(b){if(aI(b))return{data:{provider:a.provider,url:null},error:b};throw b}}async unlinkIdentity(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)throw f;return await bd(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0})})}catch(a){if(aI(a))return{data:null,error:a};throw a}}async _refreshAccessToken(a){let b=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(b,"begin");try{var c,d;let e=Date.now();return await (c=async c=>(c>0&&await a3(200*Math.pow(2,c-1)),this._debug(b,"refreshing attempt",c),await bd(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:bf})),d=(a,b)=>{let c=200*Math.pow(2,a);return b&&aR(b)&&Date.now()+c-e<3e4},new Promise((a,b)=>{(async()=>{for(let e=0;e<1/0;e++)try{let b=await c(e);if(!d(e,null,b))return void a(b)}catch(a){if(!d(e,a))return void b(a)}})()}))}catch(a){if(this._debug(b,"error",a),aI(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(b,"end")}}_isValidSession(a){return"object"==typeof a&&null!==a&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,b){let c=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:b.redirectTo,scopes:b.scopes,queryParams:b.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",b,"url",c),{data:{provider:a,url:c},error:null}}async _recoverAndRefresh(){var a;let b="#_recoverAndRefresh()";this._debug(b,"begin");try{let c=await a_(this.storage,this.storageKey);if(this._debug(b,"session from storage",c),!this._isValidSession(c)){this._debug(b,"session is not valid"),null!==c&&await this._removeSession();return}let d=(null!=(a=c.expires_at)?a:1/0)*1e3-Date.now()<9e4;if(this._debug(b,`session has${d?"":" not"} expired with margin of 90000s`),d){if(this.autoRefreshToken&&c.refresh_token){let{error:a}=await this._callRefreshToken(c.refresh_token);a&&(console.error(a),aR(a)||(this._debug(b,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",c)}catch(a){this._debug(b,"error",a),console.error(a);return}finally{this._debug(b,"end")}}async _callRefreshToken(a){var b,c;if(!a)throw new aM;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let d=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new a1;let{data:b,error:c}=await this._refreshAccessToken(a);if(c)throw c;if(!b.session)throw new aM;await this._saveSession(b.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",b.session);let d={session:b.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(a){if(this._debug(d,"error",a),aI(a)){let c={session:null,error:a};return aR(a)||await this._removeSession(),null==(b=this.refreshingDeferred)||b.resolve(c),c}throw null==(c=this.refreshingDeferred)||c.reject(a),a}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(a,b,c=!0){let d=`#_notifyAllSubscribers(${a})`;this._debug(d,"begin",b,`broadcast = ${c}`);try{this.broadcastChannel&&c&&this.broadcastChannel.postMessage({event:a,session:b});let d=[],e=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(a,b)}catch(a){d.push(a)}});if(await Promise.all(e),d.length>0){for(let a=0;a<d.length;a+=1)console.error(d[a]);throw d[0]}}finally{this._debug(d,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0,await a$(this.storage,this.storageKey,a)}async _removeSession(){this._debug("#_removeSession()"),await a0(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()"),this.visibilityChangedCallback,this.visibilityChangedCallback=null}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let a=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=a,a&&"object"==typeof a&&"function"==typeof a.unref?a.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let a=Date.now();try{return await this._useSession(async b=>{let{data:{session:c}}=b;if(!c||!c.refresh_token||!c.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let d=Math.floor((1e3*c.expires_at-a)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),d<=3&&await this._callRefreshToken(c.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof bp)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){return this._debug("#_handleVisibilityChange()"),this.autoRefreshToken&&this.startAutoRefresh(),!1}async _onVisibilityChanged(a){let b=`#_onVisibilityChanged(${a})`;this._debug(b,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"!==document.visibilityState?this._debug(b,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,b,c){let d=[`provider=${encodeURIComponent(b)}`];if((null==c?void 0:c.redirectTo)&&d.push(`redirect_to=${encodeURIComponent(c.redirectTo)}`),(null==c?void 0:c.scopes)&&d.push(`scopes=${encodeURIComponent(c.scopes)}`),"pkce"===this.flowType){let[a,b]=await a7(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(b)}`});d.push(c.toString())}if(null==c?void 0:c.queryParams){let a=new URLSearchParams(c.queryParams);d.push(a.toString())}return(null==c?void 0:c.skipBrowserRedirect)&&d.push(`skip_http_redirect=${c.skipBrowserRedirect}`),`${a}?${d.join("&")}`}async _unenroll(a){try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?{data:null,error:e}:await bd(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(aI(a))return{data:null,error:a};throw a}}async _enroll(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)return{data:null,error:f};let g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},"phone"===a.factorType?{phone:a.phone}:{issuer:a.issuer}),{data:h,error:i}=await bd(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:null==(c=null==e?void 0:e.session)?void 0:c.access_token});return i?{data:null,error:i}:("totp"===a.factorType&&(null==(d=null==h?void 0:h.totp)?void 0:d.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(a){if(aI(a))return{data:null,error:a};throw a}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return{data:null,error:e};let{data:f,error:g}=await bd(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:{code:a.code,challenge_id:a.challengeId},headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),{data:f,error:g})})}catch(a){if(aI(a))return{data:null,error:a};throw a}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?{data:null,error:e}:await bd(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:{channel:a.channel},headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(aI(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(a){let{data:b,error:c}=await this._challenge({factorId:a.factorId});return c?{data:null,error:c}:await this._verify({factorId:a.factorId,challengeId:b.id,code:a.code})}async _listFactors(){let{data:{user:a},error:b}=await this.getUser();if(b)return{data:null,error:b};let c=(null==a?void 0:a.factors)||[],d=c.filter(a=>"totp"===a.factor_type&&"verified"===a.status),e=c.filter(a=>"phone"===a.factor_type&&"verified"===a.status);return{data:{all:c,totp:d,phone:e},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async a=>{var b,c;let{data:{session:d},error:e}=a;if(e)return{data:null,error:e};if(!d)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:f}=a2(d.access_token),g=null;f.aal&&(g=f.aal);let h=g;return(null!=(c=null==(b=d.user.factors)?void 0:b.filter(a=>"verified"===a.status))?c:[]).length>0&&(h="aal2"),{data:{currentLevel:g,nextLevel:h,currentAuthenticationMethods:f.amr||[]},error:null}}))}async fetchJwk(a,b={keys:[]}){let c=b.keys.find(b=>b.kid===a);if(c||(c=this.jwks.keys.find(b=>b.kid===a))&&this.jwks_cached_at+6e5>Date.now())return c;let{data:d,error:e}=await bd(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(e)throw e;if(!d.keys||0===d.keys.length)throw new aT("JWKS is empty");if(this.jwks=d,this.jwks_cached_at=Date.now(),!(c=d.keys.find(b=>b.kid===a)))throw new aT("No matching signing key found in JWKS");return c}async getClaims(a,b={keys:[]}){try{let e,f=a;if(!f){let{data:a,error:b}=await this.getSession();if(b||!a.session)return{data:null,error:b};f=a.session.access_token}let{header:g,payload:h,signature:i,raw:{header:j,payload:k}}=a2(f);var c,d=h.exp;if(!d)throw Error("Missing exp claim");if(d<=Math.floor(Date.now()/1e3))throw Error("JWT has expired");if(!g.kid||"HS256"===g.alg||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){let{error:a}=await this.getUser(f);if(a)throw a;return{data:{claims:h,header:g,signature:i},error:null}}let l=function(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(g.alg),m=await this.fetchJwk(g.kid,b),n=await crypto.subtle.importKey("jwk",m,l,!0,["verify"]);if(!await crypto.subtle.verify(l,n,i,(c=`${j}.${k}`,e=[],!function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(c,a=>e.push(a)),new Uint8Array(e))))throw new aT("Invalid JWT signature");return{data:{claims:h,header:g,signature:i},error:null}}catch(a){if(aI(a))return{data:null,error:a};throw a}}}bs.nextInstanceID=0;let bt=bs;class bu extends bt{constructor(a){super(a)}}let bv=new class a{constructor(a,b,c){var d,e,f;if(this.supabaseUrl=a,this.supabaseKey=b,!a)throw Error("supabaseUrl is required.");if(!b)throw Error("supabaseKey is required.");const g=a.replace(/\/$/,"");this.realtimeUrl=`${g}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${g}/auth/v1`,this.storageUrl=`${g}/storage/v1`,this.functionsUrl=`${g}/functions/v1`;const h=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,i=function(a,b){let{db:c,auth:d,realtime:e,global:f}=a,{db:g,auth:h,realtime:i,global:j}=b,k={db:Object.assign(Object.assign({},g),c),auth:Object.assign(Object.assign({},h),d),realtime:Object.assign(Object.assign({},i),e),global:Object.assign(Object.assign({},j),f),accessToken:()=>{var a,b,c,d;return a=this,b=void 0,d=function*(){return""},new(c=void 0,c=Promise)(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}};return a.accessToken?k.accessToken=a.accessToken:delete k.accessToken,k}(null!=c?c:{},{db:ay,realtime:aA,auth:Object.assign(Object.assign({},az),{storageKey:h}),global:ax});this.storageKey=null!=(d=i.auth.storageKey)?d:"",this.headers=null!=(e=i.global.headers)?e:{},i.accessToken?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(a,b)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(f=i.auth)?f:{},this.headers,i.global.fetch),this.fetch=((a,b,c)=>{let d,e=(d=c||("undefined"==typeof fetch?aB.default:fetch),(...a)=>d(...a)),f="undefined"==typeof Headers?aB.Headers:Headers;return(c,d)=>{var g,h,i,j;return g=void 0,h=void 0,i=void 0,j=function*(){var g;let h=null!=(g=yield b())?g:a,i=new f(null==d?void 0:d.headers);return i.has("apikey")||i.set("apikey",a),i.has("Authorization")||i.set("Authorization",`Bearer ${h}`),e(c,Object.assign(Object.assign({},d),{headers:i}))},new(i||(i=Promise))(function(a,b){function c(a){try{e(j.next(a))}catch(a){b(a)}}function d(a){try{e(j.throw(a))}catch(a){b(a)}}function e(b){var e;b.done?a(b.value):((e=b.value)instanceof i?e:new i(function(a){a(e)})).then(c,d)}e((j=j.apply(g,h||[])).next())})}})(b,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.rest=new D(`${g}/rest/v1`,{headers:this.headers,schema:i.db.schema,fetch:this.fetch}),i.accessToken||this._listenForAuthEvents()}get functions(){return new C(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new av(this.storageUrl,this.headers,this.fetch)}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,b={},c={}){return this.rest.rpc(a,b,c)}channel(a,b={config:{}}){return this.realtime.channel(a,b)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var a,b,c,d,e,f;return c=this,d=void 0,e=void 0,f=function*(){if(this.accessToken)return yield this.accessToken();let{data:c}=yield this.auth.getSession();return null!=(b=null==(a=c.session)?void 0:a.access_token)?b:null},new(e||(e=Promise))(function(a,b){function g(a){try{i(f.next(a))}catch(a){b(a)}}function h(a){try{i(f.throw(a))}catch(a){b(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof e?c:new e(function(a){a(c)})).then(g,h)}i((f=f.apply(c,d||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,storageKey:e,flowType:f,lock:g,debug:h},i,j){let k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bu({url:this.authUrl,headers:Object.assign(Object.assign({},k),i),storageKey:e,autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,flowType:f,lock:g,debug:h,fetch:j,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(a){return new aa(this.realtimeUrl,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},null==a?void 0:a.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,b)=>{this._handleTokenChanged(a,"CLIENT",null==b?void 0:b.access_token)})}_handleTokenChanged(a,b,c){("TOKEN_REFRESHED"===a||"SIGNED_IN"===a)&&this.changedAccessToken!==c?this.changedAccessToken=c:"SIGNED_OUT"===a&&(this.realtime.setAuth(),"STORAGE"==b&&this.auth.signOut(),this.changedAccessToken=void 0)}}("https://utyaegtlratnhymumqjm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV0eWFlZ3RscmF0bmh5bXVtcWptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMzNTU5MDUsImV4cCI6MjA1ODkzMTkwNX0.B2-GTy9rJPgGTmDeB70CwfzbbTTdocp-1QzRaMNDntQ",void 0);async function bw(a){let{data:b,error:c}=await bv.from("imagens").select("categoria");if(c)return console.error("Erro ao buscar categorias:",c),[];let d=[...new Set(b.map(a=>a.categoria))],e=d.find(b=>b===a);if(e||(e=d.find(b=>b.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"")===a)),!e){let b=a.replace(/-/g," ");(e=d.find(a=>a.toLowerCase()===b.toLowerCase()))||(e=b)}console.log(`Slug: ${a} -> Real Category: ${e}`);let{data:f,error:g}=await bv.from("imagens").select("*").eq("categoria",e);return g?(console.error("Erro ao buscar imagens:",g),[]):f}async function bx({params:a}){let{category:b}=await a,c=await bw(b);return(0,w.jsx)(x.default,{category:b,initialImages:c})}a.s(["default",()=>bx],31017)}];

//# sourceMappingURL=_07cda12e._.js.map